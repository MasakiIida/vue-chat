{"ast":null,"code":"import _asyncToGenerator from \"/Users/masakiiida/Documents/Project/Portfolio/vue-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.map.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport firebase from \"@/firebase/firebase\";\nimport SideBar from \"@/components/layouts/SideBar\";\nexport default {\n  components: {\n    SideBar: SideBar\n  },\n  created: function created() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var roomRef, roomDoc, snapshot;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.roomId = _this.$route.query.room_id;\n              console.log(\"roomId\", _this.roomId);\n              roomRef = firebase.firestore().collection(\"rooms\").doc(_this.roomId);\n              _context.next = 5;\n              return roomRef.get();\n\n            case 5:\n              roomDoc = _context.sent;\n\n              if (roomDoc.exists) {\n                _context.next = 9;\n                break;\n              }\n\n              _context.next = 9;\n              return _this.$router.push(\"/\");\n\n            case 9:\n              _this.room = roomDoc.data();\n              console.log(\"room\", _this.room);\n              _context.next = 13;\n              return roomRef.collection(\"messages\").orderBy(\"createdAt\", \"asc\").get();\n\n            case 13:\n              snapshot = _context.sent;\n              snapshot.docs.map(function (doc) {\n                console.log(doc.data());\n\n                _this.messages.push(doc.data());\n              }); //   const chatRef = firebase.firestore().collection(\"chats\");\n              //   console.log(\"chatRef\", chatRef);\n              //   const snapshot = await chatRef.get();\n              //   console.log(\"snapshot\", snapshot);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  data: function data() {\n    return {\n      messages: [],\n      body: \"\",\n      roomId: \"\",\n      room: null,\n      cards: [\"Today\"],\n      drawer: null,\n      links: [[\"mdi-inbox-arrow-down\", \"Inbox\"], [\"mdi-send\", \"Send\"], [\"mdi-delete\", \"Trash\"], [\"mdi-alert-octagon\", \"Spam\"]],\n      auth: null //   invalid: false,\n\n    };\n  },\n  computed: {\n    invalid: function invalid() {\n      if (!this.body) {\n        return true;\n      }\n\n      return false;\n    }\n  },\n  methods: {\n    clear: function clear() {\n      this.body = \"\";\n    },\n    submit: function submit() {\n      this.messages.unshift({\n        message: this.body,\n        name: this.body,\n        photoURL: this.body,\n        createdAt: firebase.firestore.Timestamp.now()\n      });\n      this.body = \"\";\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;AACA;AAEA;AACAA;AACAC;AADA,GADA;AAIAC,SAJA,qBAIA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACAC;AAEAC,qBAJA,GAIAC,0DAJA;AAAA;AAAA,qBAKAD,aALA;;AAAA;AAKAE,qBALA;;AAAA,kBAMAA,cANA;AAAA;AAAA;AAAA;;AAAA;AAAA,qBAOA,uBAPA;;AAAA;AASA;AACAH;AAVA;AAAA,qBAYAC,QACAG,UADA,CACA,UADA,EAEAC,OAFA,CAEA,WAFA,EAEA,KAFA,EAGAC,GAHA,EAZA;;AAAA;AAYAC,sBAZA;AAgBAA;AACAP;;AACA;AACA,eAHA,EAhBA,CAqBA;AACA;AACA;AACA;;AAxBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyBA,GA7BA;AA8BAQ;AAAA;AACAC,kBADA;AAEAC,cAFA;AAGAC,gBAHA;AAIAC,gBAJA;AAKAC,sBALA;AAMAC,kBANA;AAOAC,cACA,iCADA,EAEA,oBAFA,EAGA,uBAHA,EAIA,6BAJA,CAPA;AAaAC,gBAbA,CAcA;;AAdA;AAAA,GA9BA;AA8CAC;AACAC,WADA,qBACA;AACA;AACA;AACA;;AACA;AACA;AANA,GA9CA;AAsDAC;AACAC,SADA,mBACA;AACA;AACA,KAHA;AAIAC,UAJA,oBAIA;AACA;AACAC,0BADA;AAEAC,uBAFA;AAGAC,2BAHA;AAIAC;AAJA;AAMA;AACA;AAZA;AAtDA","names":["components","SideBar","created","console","roomRef","firebase","roomDoc","collection","orderBy","get","snapshot","data","messages","body","roomId","room","cards","drawer","links","auth","computed","invalid","methods","clear","submit","message","name","photoURL","createdAt"],"sourceRoot":"src/views","sources":["ChatBoard.vue"],"sourcesContent":["<template>\n <v-app id=\"inspire\">\n  <SideBar />\n  <v-main>\n   <h1>{{ room ? room.name : \"\" }}</h1>\n   <v-container class=\"py-8 px-6\" fluid>\n    <v-row>\n     <v-col v-for=\"card in cards\" :key=\"card\" cols=\"12\">\n      <v-card>\n       <v-subheader>{{ card }}</v-subheader>\n\n       <v-list two-line>\n        <template v-for=\"(data, index) in messages\">\n         <v-list-item :key=\"index\">\n          <v-list-item-avatar color=\"grey darken-1\"> </v-list-item-avatar>\n\n          <v-list-item-content>\n           <v-list-item-subtitle class=\"message\">\n            {{ data.message }}\n           </v-list-item-subtitle>\n          </v-list-item-content>\n         </v-list-item>\n\n         <v-divider v-if=\"n !== 6\" :key=\"`divider-${index}`\" inset></v-divider>\n        </template>\n       </v-list>\n      </v-card>\n     </v-col>\n    </v-row>\n   </v-container>\n   <v-textarea\n    v-model=\"body\"\n    append-outer-icon=\"mdi-comment\"\n    class=\"mx-2\"\n    label=\"メッセージを送信する\"\n    rows=\"3\"\n    auto-grow\n   ></v-textarea>\n   <v-btn class=\"mr-4\" type=\"submit\" :disabled=\"invalid\" @click=\"submit\">\n    submit\n   </v-btn>\n   <v-btn @click=\"clear\"> clear </v-btn>\n  </v-main>\n </v-app>\n</template>\n\n<script>\nimport firebase from \"@/firebase/firebase\";\nimport SideBar from \"@/components/layouts/SideBar\";\n\nexport default {\n components: {\n  SideBar,\n },\n async created() {\n  this.roomId = this.$route.query.room_id;\n  console.log(\"roomId\", this.roomId);\n\n  const roomRef = firebase.firestore().collection(\"rooms\").doc(this.roomId);\n  const roomDoc = await roomRef.get();\n  if (!roomDoc.exists) {\n   await this.$router.push(\"/\");\n  }\n  this.room = roomDoc.data();\n  console.log(\"room\", this.room);\n\n  const snapshot = await roomRef\n   .collection(\"messages\")\n   .orderBy(\"createdAt\", \"asc\")\n   .get();\n  snapshot.docs.map((doc) => {\n   console.log(doc.data());\n   this.messages.push(doc.data());\n  });\n\n  //   const chatRef = firebase.firestore().collection(\"chats\");\n  //   console.log(\"chatRef\", chatRef);\n  //   const snapshot = await chatRef.get();\n  //   console.log(\"snapshot\", snapshot);\n },\n data: () => ({\n  messages: [],\n  body: \"\",\n  roomId: \"\",\n  room: null,\n  cards: [\"Today\"],\n  drawer: null,\n  links: [\n   [\"mdi-inbox-arrow-down\", \"Inbox\"],\n   [\"mdi-send\", \"Send\"],\n   [\"mdi-delete\", \"Trash\"],\n   [\"mdi-alert-octagon\", \"Spam\"],\n  ],\n  auth: null,\n  //   invalid: false,\n }),\n computed: {\n  invalid() {\n   if (!this.body) {\n    return true;\n   }\n   return false;\n  },\n },\n methods: {\n  clear() {\n   this.body = \"\";\n  },\n  submit() {\n   this.messages.unshift({\n    message: this.body,\n    name: this.body,\n    photoURL: this.body,\n    createdAt: firebase.firestore.Timestamp.now(),\n   });\n   this.body = \"\";\n  },\n },\n};\n</script>\n\n<style scoped>\n.message {\n text-align: left;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}