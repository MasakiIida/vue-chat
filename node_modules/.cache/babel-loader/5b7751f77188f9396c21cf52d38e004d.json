{"ast":null,"code":"import _asyncToGenerator from \"/Users/masakiiida/Documents/Project/Portfolio/vue-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.function.name.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport firebase from \"@/firebase/firebase\";\nexport default {\n  data: function data() {\n    return {\n      dialog: false,\n      name: \"\",\n      file: null\n    };\n  },\n  methods: {\n    onSubmit: function onSubmit() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var collection, docId, thumbnailUrl, filePath, roomRef;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                collection = firebase.collection(\"rooms\");\n                docId = collection.doc().id;\n                thumbnailUrl = \"\";\n\n                if (!_this.file) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                filePath = \"/room/\".concat(_this.file.name);\n                _context2.next = 7;\n                return firebase.storage().ref().child(filePath).put(_this.file).then( /*#__PURE__*/function () {\n                  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(snapshot) {\n                    return regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return snapshot.ref.getDownloadURL();\n\n                          case 2:\n                            thumbnailUrl = _context.sent;\n                            console.log(\"thumbnailUrl\", thumbnailUrl);\n\n                          case 4:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x) {\n                    return _ref.apply(this, arguments);\n                  };\n                }());\n\n              case 7:\n                roomRef = firebase.firestore().collection(\"rooms\");\n                _context2.next = 10;\n                return roomRef.add({\n                  name: _this.name,\n                  thumbnailUrl: thumbnailUrl,\n                  createdAt: firebase.firestore.Timestamp.now()\n                }).then(function (result) {\n                  console.log(\"success to create room\", result);\n\n                  _this.$router.push(\"/chat\" + docId);\n\n                  _this.dialog = false;\n                });\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AAEA;AACAA;AAAA;AACAC,mBADA;AAEAC,cAFA;AAGAC;AAHA;AAAA,GADA;AAMAC;AACAC,YADA,sBACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACAC,0BADA,GACAC,4BADA;AAEAC,qBAFA,GAEAF,mBAFA;AAGAG,4BAHA,GAGA,EAHA;;AAAA,qBAIA,UAJA;AAAA;AAAA;AAAA;;AAKAC,wBALA,mBAKA,eALA;AAAA;AAAA,uBAMAH,SACAI,OADA,GAEAC,GAFA,GAGAC,KAHA,CAGAH,QAHA,EAIAI,GAJA,CAIA,UAJA,EAKAC,IALA;AAAA,qFAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACAC,6BADA;;AAAA;AACAP,wCADA;AAEAQ;;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBALA;;AAAA;AAAA;AAAA;AAAA,oBANA;;AAAA;AAiBAC,uBAjBA,GAiBAX,wCAjBA;AAAA;AAAA,uBAkBAW,QACAC,GADA,CACA;AACAjB,kCADA;AAEAO,4CAFA;AAGAW;AAHA,iBADA,EAMAL,IANA,CAMA;AACAE;;AACA;;AACA;AACA,iBAVA,CAlBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA6BA;AA9BA;AANA","names":["data","dialog","name","file","methods","onSubmit","collection","firebase","docId","thumbnailUrl","filePath","storage","ref","child","put","then","snapshot","console","roomRef","add","createdAt"],"sourceRoot":"src/components/modal","sources":["CreateRoom.vue"],"sourcesContent":["/* eslint-disable */\n<template>\n <!-- <v-row justify=\"center\"> -->\n <v-dialog v-model=\"dialog\" persistent max-width=\"600px\">\n  <template v-slot:activator=\"{ on, attrs }\">\n   <v-avatar color=\"primary\" size=\"128\" dark v-bind=\"attrs\" v-on=\"on\">\n    <!-- <v-btn color=\"primary\"> -->\n    <v-icon x-large color=\"white\"> mdi-home-plus </v-icon>\n    <!-- </v-btn> -->\n   </v-avatar>\n  </template>\n  <v-card>\n   <v-card-title>\n    <span class=\"text-h5\">新しいルーム</span>\n   </v-card-title>\n   <v-card-text>\n    <v-container>\n     <v-row>\n      <v-col cols=\"12\">\n       <v-text-field\n        v-model=\"name\"\n        label=\"ルーム名を入力してください\"\n        required\n       ></v-text-field>\n      </v-col>\n      <v-col cols=\"12\">\n       <v-file-input\n        v-model=\"file\"\n        label=\"ルームアイコンを選択してください\"\n        truncate-length=\"15\"\n        accept=\"image/*\"\n       ></v-file-input>\n      </v-col>\n     </v-row>\n    </v-container>\n   </v-card-text>\n   <v-card-actions>\n    <v-spacer></v-spacer>\n    <v-btn\n     color=\"success darken-1\"\n     @click=\"onSubmit\"\n     :to=\"{ path: '/chat', query: { room_id: room.id } }\"\n    >\n     <v-icon left> mdi-check-bold </v-icon>作成\n    </v-btn>\n    <v-btn color=\"blue darken-1\" text @click=\"dialog = false\"> 閉じる </v-btn>\n   </v-card-actions>\n  </v-card>\n </v-dialog>\n <!-- </v-row> -->\n</template>\n\n<script>\nimport firebase from \"@/firebase/firebase\";\n\nexport default {\n data: () => ({\n  dialog: false,\n  name: \"\",\n  file: null,\n }),\n methods: {\n  async onSubmit() {\n   const collection = firebase.collection(\"rooms\");\n   const docId = collection.doc().id;\n   let thumbnailUrl = \"\";\n   if (this.file) {\n    const filePath = `/room/${this.file.name}`;\n    await firebase\n     .storage()\n     .ref()\n     .child(filePath)\n     .put(this.file)\n     .then(async (snapshot) => {\n      thumbnailUrl = await snapshot.ref.getDownloadURL();\n      console.log(\"thumbnailUrl\", thumbnailUrl);\n     });\n   }\n\n   const roomRef = firebase.firestore().collection(\"rooms\");\n   await roomRef\n    .add({\n     name: this.name,\n     thumbnailUrl: thumbnailUrl,\n     createdAt: firebase.firestore.Timestamp.now(),\n    })\n    .then((result) => {\n     console.log(\"success to create room\", result);\n     this.$router.push(\"/chat\" + docId);\n     this.dialog = false;\n    });\n  },\n },\n};\n</script>\n\n<style>\n.newroom-icon {\n display: block !important;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}